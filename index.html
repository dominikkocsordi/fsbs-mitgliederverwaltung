<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Mitgliederportal</title>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
:root{
  --bg1:#0b1220;
  --bg2:#111c2b;
  --bg3:#0b2a33;

  --glass: rgba(255,255,255,.10);
  --border: rgba(255,255,255,.22);

  --text: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.68);

  --accent1:#38bdf8;
  --accent2:#0ea5e9;

  --danger1:#fb7185;
  --danger2:#e11d48;

  --shadow: 0 20px 55px rgba(0,0,0,.40);
  --ok: rgba(34,197,94,.95);

  /* Platz f√ºr fixierten Badge */
  --badge-safe-top: 92px;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: system-ui,-apple-system,"Segoe UI",sans-serif;
  color: var(--text);
  background:
    radial-gradient(900px 500px at 15% 10%, rgba(56,189,248,.25), transparent 60%),
    radial-gradient(900px 500px at 85% 20%, rgba(34,197,94,.18), transparent 60%),
    radial-gradient(800px 450px at 60% 90%, rgba(251,113,133,.18), transparent 60%),
    linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
  padding: var(--badge-safe-top) 16px 40px;
  display:flex;
  justify-content:center;
}

.app{ width:100%; max-width:1200px; }

/* ================= BADGE ================= */

.authFloating{
  position: fixed;
  top: 16px;
  right: 16px;
  z-index: 999;

  display:flex;
  align-items:center;
  gap:10px;

  padding:10px 14px;
  border-radius:999px;

  background: rgba(255,255,255,.10);
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 0 18px 55px rgba(0,0,0,.40);
  backdrop-filter: blur(18px);

  max-width: calc(100vw - 32px);
}

.dot{
  width:10px;height:10px;border-radius:999px;
  background: rgba(255,255,255,.35);
}
.dot.ok{
  background: var(--ok);
  box-shadow:
    0 0 0 2px rgba(34,197,94,.25),
    0 0 20px rgba(34,197,94,.55);
}
.dot.warn{ background: rgba(255,255,255,.35); }

.authAvatar{
  width:30px;height:30px;
  border-radius:999px;
  display:grid;
  place-items:center;
  font-weight:800;
  font-size:12px;
  border:1px solid rgba(255,255,255,.18);
}
.authInfo{ min-width:0; }
.authState{ font-size:13px;font-weight:700; }
.authMail{
  font-size:11px;
  color:rgba(255,255,255,.6);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* ================= TABLE ================= */

.tableWrap{ overflow:auto; }
table{
  width:100%;
  border-collapse:collapse;
  min-width:900px;
}
th,td{
  padding:14px 12px;
  border-bottom:1px solid rgba(255,255,255,.12);
}
th{ color:var(--muted); }

.pill{
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:700;
  border:1px solid rgba(255,255,255,.18);
  display:inline-block;
}

.pill-status-volle{ background:rgba(34,197,94,.20); color:#bbf7d0; }
.pill-status-anw{ background:rgba(56,189,248,.20); color:#c7f9ff; }
.pill-status-pau{ background:rgba(234,179,8,.20); color:#fde68a; }
.pill-status-aus{ background:rgba(239,68,68,.20); color:#fecaca; }

/* ================= MOBILE ================= */

@media (max-width:640px){

  :root{ --badge-safe-top: 110px; }

  table{ min-width:700px; }

  th:nth-child(3),
  td:nth-child(3){
    display:none; /* Email ausblenden auf sehr kleinen Screens */
  }
}

</style>
</head>
<body>

<div class="authFloating">
  <span class="dot warn" id="authDot"></span>
  <div class="authAvatar" id="authAvatar">U</div>
  <div class="authInfo">
    <div class="authState" id="authState">nicht eingeloggt</div>
    <div class="authMail" id="authMail"></div>
  </div>
</div>

<div class="app">
  <h1>Mitgliederportal</h1>

  <div class="tableWrap">
    <table>
      <thead>
        <tr>
          <th>Nr</th>
          <th>Name</th>
          <th>Email</th>
          <th>Ressort</th>
          <th>Rolle</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="list"></tbody>
    </table>
  </div>
</div>

<script>
/* Supabase */
const sb = supabase.createClient(
  "https://hdhueuihmxbskiusenpe.supabase.co",
  "sb_publishable_H6YjVStNvwY-VnZuZCYDxw_mOWEvAAW"
);

function statusClass(s){
  s=(s||"").toLowerCase();
  if(s.startsWith("voll"))return"pill-status-volle";
  if(s.startsWith("anw"))return"pill-status-anw";
  if(s.startsWith("pau"))return"pill-status-pau";
  if(s.startsWith("aus"))return"pill-status-aus";
  return"";
}

async function load(){
  const {data}=await sb.from("members").select("*");
  const list=document.getElementById("list");
  list.innerHTML=data.map(m=>`
    <tr>
      <td>${m.mitgliedernummer||""}</td>
      <td>${m.vorname||""} ${m.nachname||""}</td>
      <td>${m.email||""}</td>
      <td><span class="pill">${m.ressort||"-"}</span></td>
      <td><span class="pill">${m.rolle||"-"}</span></td>
      <td><span class="pill ${statusClass(m.status)}">${m.status||"-"}</span></td>
    </tr>
  `).join("");
}

load();
</script>

</body>
</html>
